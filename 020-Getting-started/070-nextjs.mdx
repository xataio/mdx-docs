---
title: Next.js with Xata starter guide
navTitle: Next.js
keywords: ['nextjs']
description: Get started with Next.js and Xata
slug: getting-started/nextjs
published: true
---

In this guide, we'll create a new [Next.js][2] application and walk through adding Xata database and search functionality to it. We'll build a basic blog application to demonstrate the funcationality, however you can apply these basics to other types of app.

The completed [Next.js and Xata code](https://github.com/xataio/examples/tree/main/apps/nextjs-getting-started) for this guide is available via the [Xata `examples` repo](https://github.com/xataio/examples) on GitHub.

## Before you begin

Install the Xata CLI:

```sh
npm install -g @xata.io/cli
```

And login to your Xata account with the Xata CLI. Running the following command will open a new browser window. If you're not already logged into Xata you can go through the login or signup process. Run the following command to begin the authentication workflow:

```sh
xata auth login
```

On completion the command will create a new API key for your user account which you should [see in account settings page within the Xata UI][1]. That key will also be stored locally on your computer (the location might vary for each OS). It looks like this:

```toml
# .config/xata/credentials
[default]
apiKey=YOUR_API_KEY_HERE
```

## Create a new Next.js app

Let's begin by creating a new Next.js application:

```sh
npx create-next-app@latest --typescript xata-nextjs
```

<details>
  <summary><code>npx create-next-app</code> output</summary>
  $ npx create-next-app@latest --typescript xata-nextjs
  Need to install the following packages:
  create-next-app@13.4.13
  Ok to proceed? (y)
  âœ” Would you like to use ESLint? â€¦ No / Yes
  âœ” Would you like to use Tailwind CSS? â€¦ No / Yes
  âœ” Would you like to use `src/` directory? â€¦ No / Yes
  âœ” Would you like to use App Router? (recommended) â€¦ No / Yes
  âœ” Would you like to customize the default import alias? â€¦ No / Yes
  Creating a new Next.js app in ./xata-nextjs.

Using npm.

Initializing project with template: app-tw

Installing dependencies:

- react
- react-dom
- next
- typescript
- @types/react
- @types/node
- @types/react-dom
- tailwindcss
- postcss
- autoprefixer
- eslint
- eslint-config-next

added 314 packages, and audited 315 packages in 22s

107 packages are looking for funding
run `npm fund` for details

found 0 vulnerabilities
Initialized a git repository.

Success! Created xata-nextjs at ./xata-nextjs

</details>

Once the command has completed, move to the `xata-nextjs` directory and run the application:

```sh
cd xata-nextjs
npm run dev
```

By default the application will run on `http://localhost:3000`.

## Create a new database

With the Xata CLI installed and logged in, and a new Next.js application in place, use the Xata CLI to create a new database. Accept all the prompt defaults for the following command:

```sh
xata init
```

<details>
  <summary><code>xata init</code> output</summary>

  <pre>
    $ xata init\
    ðŸ¦‹ Initializing project... We will ask you some questions.

    You have a single workspace, using it by default: Phil-Leggetter-s-workspace-hc84d7
    âœ” Select a database or create a new one â€º \<Create a new database>
    âœ” New database name â€¦ xata-nextjs-run-through-1
    âœ” Select a region â€º eu-west-1
    âœ” Add .env to .gitignore? â€¦ yes
    âœ” Generate code and types from your Xata database â€º TypeScript
    âœ” Choose the output path for the generated code â€¦ src/xata.ts

    Setting up Xata...

    Created Xata config: .xatarc

    Creating .env file
    set XATA\*API\_KEY=xau\*\*\*\*\*\***\***\*\*\*\***\***\*\***\*\*\*\***\*\*\*\*
    set XATA\_BRANCH=main

    Added .env file to .gitignore

    i Running npm install --save @xata.io/client

    added 1 package, and audited 316 packages in 992ms

    107 packages are looking for funding
    run `npm fund` for details

    found 0 vulnerabilities

    No new migrations to pull from main branch
    Generated Xata code to ./src/xata.ts

    âœ” Project setup with Xata ðŸ¦‹

    i Setup tables and columns at https://app.xata.io/workspaces/xata-workspace-hc84d7/dbs/xata-nextjs:eu-west-1

    i Use xata pull main to regenerate code and types from your Xata database
  </pre>

</details>

On completion the CLI will create `.env`, `.xatarc`, and `src/xata.ts` files within your project folder with the correct credentials to access your database.

Your `.env` file should look something like this:

```bash title=".env"
XATA_API_KEY=YOUR_API_KEY_HERE
XATA_BRANCH=main
```

Since we selected TypeScript support it also created files that provide typings and functions to call using Xata's TypeScript SDK. This will additionally be referenced in the `.xatarc` file as follows:

```json
{
  "databaseUrl": "https://xata-nextjs-database-url"
  "codegen": {
    "output": "src/xata.ts"
  }
}
```

The `src/xata.ts` includes generated code that typically you should never touch manually.

## Define the datbase schema and seed via CSV import

You can use the [Xata UI][0] to manually define your schema and add data. However, for this guide we'll walk through using the Xata CLI and a CSV file to:

1.  Auto generate a schema based on column headings for names and data types inferred from the column values
2.  Seed the database with data

**TODO: Update URL to CSV file**

First, download the [example posts CSV file](https://raw.githubusercontent.com/leggetter/xata-examples/nextjs-getting-started/apps/getting-started-nextjs/seed/blog-posts.csv). You can either do this manually or by running the follow command:

```sh
curl https://raw.githubusercontent.com/leggetter/xata-examples/nextjs-getting-started/apps/getting-started-nextjs/seed/blog-posts.csv --create-dirs -o seed/blog-posts.csv
```

Next, import the CSV:

```sh
xata import csv seed/blog-posts.csv --table Posts --create
```

Now, if you open up the Xata UI and navigate to your database (you can also run `xata browse` to open up a browser window), you will see the **Posts** table:

![Posts table](images/xata-table-posts.png)

Click on the **Schema** link to see the schema definition with the interred data types:

![Posts schema](images/xata-schema-posts.png)

With the database schema in place the final step is to generate the code that allows us to access and query the data from our Next.js application. To do this, run:

```sh
xata pull main
```

This updates the contents of `src/xata.ts` based on the schema defined on the `main` branch of our database. So, if you make any further changes to the schema, run `xata pull <branch>` to updated the auto-generated code.

## Query and list the posts

Now we're ready to integrate Xata into the Next.js codebase. Let's start by stripping back the landing page, `src/app/page.tsx`, to a bare template:

```tsx title="src/app/page.tsx"
export default async function Home() {
  return (
    <main className="p-8 lg:p-24 min-h-screen">
      <div className="z-10 h-50 w-full max-w-5xl items-center justify-between text-xl lg:flex">
        <p className="fixed left-0 top-0 flex w-full justify-center pb-6 pt-8 lg:static lg:w-auto bg-gradient-to-b from-white via-white via-65% dark:from-black dark:via-black">
          <a href="/">Get started with Xata and Next.js</a>
        </p>
        <div className="fixed bottom-0 left-0 flex w-full items-end justify-center bg-gradient-to-t from-white via-white dark:from-black dark:via-black lg:static lg:h-auto lg:w-auto lg:bg-none">
          <a href="https://xata.io" className="w-20">
            <img src="https://raw.githubusercontent.com/leggetter/xata-examples/5b0715c9ba36556400b6121bd224203cb89f7741/docs/app_logo.svg" />
          </a>
        </div>
      </div>

      <div className="w-full max-w-5xl mt-16"></div>
    </main>
  );
}
```

Next, import the auto-generated `getXataClient` function from `src/xata.ts`, get all the posts using the client, and list them within the page:

```tsx title="src/app/page.tsx"
// highlight-start
import { getXataClient } from '@/xata';

const xata = getXataClient();
// highlight-end

export default async function Home() {
  // highlight-start
  const records = await xata.db.Posts.getAll();
  // highlight-end

  return (
    <main className="p-8 lg:p-24 min-h-screen">
      <div className="z-10 h-50 w-full max-w-5xl items-center justify-between text-xl lg:flex">
        <p className="fixed left-0 top-0 flex w-full justify-center pb-6 pt-8 lg:static lg:w-auto bg-gradient-to-b from-white via-white via-65% dark:from-black dark:via-black">
          <a href="/">Get started with Xata and Next.js</a>
        </p>
        <div className="fixed bottom-0 left-0 flex w-full items-end justify-center bg-gradient-to-t from-white via-white dark:from-black dark:via-black lg:static lg:h-auto lg:w-auto lg:bg-none">
          <a href="https://xata.io" className="w-20">
            <img src="https://raw.githubusercontent.com/leggetter/xata-examples/5b0715c9ba36556400b6121bd224203cb89f7741/docs/app_logo.svg" />
          </a>
        </div>
      </div>
      // highlight-start
      <div className="w-full max-w-5xl mt-16">
        {records.length === 0 && <p>No blog posts found</p>}
        {records.map((record) => (
          <div key={record.id} className="mb-16">
            <p className="text-xs mb-2 text-purple-950 dark:text-purple-200">{record.pubDate?.toDateString()}</p>
            <h2 className="text-2xl mb-2">
              <a href={`posts/${record.slug}`}>{record.title}</a>
            </h2>
            <p className="text-purple-950 dark:text-purple-200 mb-5">{record.description}</p>
            <a
              href={`posts/${record.slug}`}
              className="px-4 py-2 font-semibold text-sm bg-purple-700 text-white rounded-lg shadow-sm w-fit"
            >
              Read more &rarr;
            </a>
          </div>
        ))}
      </div>
      // highlight-end
    </main>
  );
}
```

Let's break down what's happening the the code above.

First, we import the `getXataClient` function and assign the result of calling that function to a variable named `xata`:

```tsx
import { getXataClient } from '@/xata';

const xata = getXataClient();
```

Then, within the `Home` function, we use the `xata` client instance to get all the posts stored in the database. This is achieved via the auto-generated `Posts` property which exposes a number of helper functions. In this case we use the \[]`getAll`]\(https://xata.io/docs/typescript-client/get#the-typescript-sdk-functions-for-querying) helper function to get all the Post records.

```tsx
export default async function Home() {
  const records = await xata.db.Posts.getAll();

  ...
}
```

Finally, we update the UI to display the result of the `getAll` call. If not records are present we should a message saying "No blog posts found". Otherwise, we loop through the `records` using `records.map` and access the columns of each Post record using their properties: `id` as a unique identifier for the `key` attribute, `pubDate` to show the date the blog post was published, `slug` to link to individual blog posts (which we'll use later), `title` for the title of the post, and `description` for the textual descript of the post:

```tsx
<div className="w-full max-w-5xl mt-16">
  {records.length === 0 && <p>No blog posts found</p>}
  {records.map((record) => (
    <div key={record.id} className="mb-16">
      <p className="text-xs mb-2 text-purple-950 dark:text-purple-200">{record.pubDate?.toDateString()}</p>
      <h2 className="text-2xl mb-2">
        <a href={`posts/${record.slug}`}>{record.title}</a>
      </h2>
      <p className="text-purple-950 dark:text-purple-200 mb-5">{record.description}</p>
      <a
        href={`posts/${record.slug}`}
        className="px-4 py-2 font-semibold text-sm bg-purple-700 text-white rounded-lg shadow-sm w-fit"
      >
        Read more &rarr;
      </a>
    </div>
  ))}
</div>
```

This results in the page looking as follows:

![List of blog posts](images/getting-started-blog-listing.png)

## Query and show a single posts

## Search posts

## What you've learned

## Where next

---

## Create a new page to output our posts

Create a new file at `src/pages/posts.tsx` and start with a typical Hello World output. Next JS will render and pages added to the `pages` directory as distinct URL. This means we can find our new page at https://localhost:3000/posts

```tsx
export default function PostsListsPage() {
  return (
    <>
      <h1>My xata posts</h1>
    </>
  );
}
```

Next let's import the `getXataClient` function which was provided to us by the `xata init` command that was run earlier. It should have placed the file in `src/xata.ts`. You'll notice that if we save this file, Next.js will error out with the following message.

<Alert status="warning">
  Error: You are trying to use Xata from the browser, which is potentially a non-secure environment. If you understand
  the security concerns, such as leaking your credentials, pass `enableBrowser: true` to the client options to remove
  this error.
</Alert>

```tsx {1-3}
import { getXataClient } from '../xata';
// We'll assign the client to xata to make it easier to call
const xata = getXataClient();

export default function PostsListPage() {
  return (
    <>
      <h1>My xata posts</h1>
    </>
  );
}
```

To fix the error we'll need to utilize the Xata client in Next.js's server-side mode. This can be done with the `getServerSideProps` function that Next.js provides.

```tsx {4-13}
import { getXataClient } from '../xata';
const xata = getXataClient();

// We will make the query to Xata on the server.
// This will allow the query to read the API_KEY from the .env file
export const getServerSideProps = async () => {
  const records = await xata.db.Posts.getMany();
  return {
    props: {
      records
    }
  };
};

export default function PostsListPage() {
  return (
    <>
      <h1>My xata posts</h1>
    </>
  );
}
```

On save, you'll notice the page still errors:

<Alert status="warning">
  Error: Error serializing `.records[0].xata.createdAt` returned from `getServerSideProps` in "/posts". `object`
  ("\[object Date]") cannot be serialized as JSON. Only return JSON serializable data types.
</Alert>

This error occurs because Xata stores date fields as an object. To resolve this issue, use the `toSerializable` function that is provided by the SDK. Note that the type returned by `toSerializable()` is `JSONData<PostsRecord>`. This helper type converts all properties to JSON serializable. This means they can be passed client-side while still keeping the end-to-end type safety of TypeScript.

```tsx {10}
import { getXataClient } from '../xata';
const xata = getXataClient();

// We will make the query to Xata on the server.
// This will allow the query to read the API_KEY from the .env file
export const getServerSideProps = async () => {
  const records = await xata.db.Posts.getMany();
  return {
    props: {
      records: records.map((record) => record.toSerializable())
    }
  };
};

export default function PostsListPage() {
  return (
    <>
      <h1>My xata posts</h1>
    </>
  );
}
```

On save our page should contain no errors. The last thing to do is pass our newly created server-side props to the render so we can see the results on the page.

```tsx {17-36}
import { getXataClient, PostsRecord } from '../xata';
// We'll assign the client to xata to make it easier to call
const xata = getXataClient();

// We will make the query to Xata on the server.
// This will allow the query to read the API_KEY from the .env file
export const getServerSideProps = async () => {
  const records = await xata.db.Posts.getMany();
  return {
    props: {
      records: records.map((record) => record.toSerializable())
    }
  };
};

// Pass the props defined above to the page and map against it
export default function PostsListPage({ records }: InferGetServerSidePropsType<typeof getServerSideProps>) {
  return (
    <>
      <h1>My xata posts</h1>
      {records.map((record) => (
        <div key={record.id}>
          <h2>{record.title}</h2>
          <p>{record.id}</p>
          <p>{record.body}</p>
          <p>{record.pubDate}</p>
        </div>
      ))}
    </>
  );
}
```

In Next.js, it is recommended to use the `InferGetServerSidePropsType` helper to infer the type of the props returned by `getServerSideProps`, so that types match the query results.

At this point you should have a basic understanding of how to query Xata records from the Database with Next.js.

[0]: https://app.xata.io
[1]: https://app.xata.io/settings
[2]: https://nextjs.org/
